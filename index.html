<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simulador - SalaPronta</title>
  <style>
    :root { --accent:#0b6b73; --muted:#444; --bg:#fff; --card:#f7f7f7; --radius:10px; font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, Arial; }
    .simulator { max-width:760px; margin:18px auto; padding:20px; background:var(--bg); border-radius:var(--radius); box-shadow:0 6px 18px rgba(0,0,0,0.06); color:var(--muted); }
    h2 { margin:0 0 14px 0; color:var(--accent) }
    .grid { display:grid; grid-template-columns:1fr 1fr; gap:14px; }
    label { display:block; font-weight:600; margin-bottom:6px }
    select, input[type="number"] { width:100%; padding:10px; border-radius:8px; border:1px solid #ddd; box-sizing:border-box; font-size:14px; }
    .section { margin-bottom:16px; }
    .add-ons { background:var(--card); padding:12px; border-radius:8px }
    .row { display:flex; gap:10px; align-items:center; margin-bottom:8px; }
    .qty { width:78px; }
    .output { padding:14px; border-radius:8px; background:linear-gradient(180deg,#fff,#fbfbfb); border:1px solid #eee; }
    .price-big { font-size:22px; font-weight:700; color:#0b6b73 }
    .muted { color:#666; font-size:13px }
    button.cta { background:var(--accent); color:#fff; border:0; padding:10px 14px; border-radius:8px; font-weight:700; cursor:pointer; margin-top:10px; }
    .breakdown { font-size:14px; margin-top:10px; }
    @media (max-width:720px) { .grid { grid-template-columns:1fr; } }
  </style>
</head>
<body>
  <div class="simulator" id="simulator-standalone">
    <h2>Simulador de Locação — SalaPronta</h2>

    <div class="section">
      <label for="room">1) Selecione o tamanho da sala</label>
      <select id="room">
        <option value="s1" data-price="80">Sala 1 - 20m² (com isolamento acústico) — R$ 80 / dia</option>
        <option value="s2" data-price="80">Sala 2 - 20m² (com isolamento acústico) — R$ 80 / dia</option>
        <option value="s3" data-price="100">Sala 3 - 60m² (sem isolamento acústico) — R$ 100 / dia</option>
        <option value="s4" data-price="60">Sala 4 - 15m² (sem isolamento acústico) — R$ 60 / dia</option>
      </select>
    </div>

    <div class="section">
      <label>2) Configuração (escolha 1)</label>
      <div class="grid">
        <div>
          <input type="radio" id="cfg_chairs" name="config" value="chairs" checked>
          <label for="cfg_chairs">Cadeiras universitárias (até 10 unidades)</label>
          <div style="margin-top:6px">
            <input type="number" id="chairs_qty" class="qty" min="1" max="10" value="10">
            <div class="muted">R$ 4 / cadeira / dia</div>
          </div>
        </div>

        <div>
          <input type="radio" id="cfg_maca" name="config" value="maca">
          <label for="cfg_maca">Maca (1 unidade)</label>
          <div class="muted">R$ 25 / dia</div>
        </div>

        <div>
          <input type="radio" id="cfg_poltrona" name="config" value="poltrona">
          <label for="cfg_poltrona">Poltrona (até 2 unidades)</label>
          <div style="margin-top:6px">
            <input type="number" id="poltrona_qty" class="qty" min="1" max="2" value="1">
            <div class="muted">R$ 25 / poltrona / dia</div>
          </div>
        </div>

        <div>
          <input type="radio" id="cfg_table" name="config" value="mesa">
          <label for="cfg_table">Mesa de reunião + 6 cadeiras</label>
          <div class="muted">R$ 20 / dia</div>
        </div>
      </div>
    </div>

    <div class="section">
      <label>3) Adicionais (marque os que quiser)</label>
      <div class="add-ons">
        <div class="row">
          <input type="checkbox" id="addon_projector"><label for="addon_projector">Projetor</label>
          <div style="margin-left:auto">
            <input type="number" id="addon_projector_q" class="qty" min="1" max="5" value="1" disabled>
            <div class="muted">R$ 50 / unidade / dia</div>
          </div>
        </div>

        <div class="row">
          <input type="checkbox" id="addon_tv"><label for="addon_tv">TV 32"</label>
          <div style="margin-left:auto">
            <input type="number" id="addon_tv_q" class="qty" min="1" max="5" value="1" disabled>
            <div class="muted">R$ 20 / unidade / dia</div>
          </div>
        </div>

        <div class="row">
          <input type="checkbox" id="addon_desktop"><label for="addon_desktop">Computador Desktop</label>
          <div style="margin-left:auto">
            <input type="number" id="addon_desktop_q" class="qty" min="1" max="5" value="1" disabled>
            <div class="muted">R$ 20 / unidade / dia</div>
          </div>
        </div>

        <div class="row">
          <input type="checkbox" id="addon_notebook"><label for="addon_notebook">Notebook</label>
          <div style="margin-left:auto">
            <input type="number" id="addon_notebook_q" class="qty" min="1" max="5" value="1" disabled>
            <div class="muted">R$ 50 / unidade / dia</div>
          </div>
        </div>
      </div>
    </div>

    <div class="section">
      <label>4) Período</label>
      <select id="period">
        <option value="1">1 dia (08:00 às 22:00)</option>
        <option value="2">2 dias (08:00 às 22:00) — 5% desconto na sala</option>
        <option value="3">3 dias (08:00 às 22:00) — 10% desconto na sala</option>
        <option value="4">4 dias (08:00 às 22:00) — 15% desconto na sala</option>
        <option value="5">5 dias (08:00 às 22:00) — 20% desconto na sala</option>
      </select>
    </div>

    <div class="section output">
      <div style="display:flex; justify-content:space-between; align-items:center">
        <div>
          <div class="muted">Total estimado</div>
          <div class="price-big" id="totalPrice">R$ 0,00</div>
        </div>
        <div style="text-align:right">
          <div class="muted">Dias</div>
          <div id="daysLabel">1</div>
        </div>
      </div>

      <div class="breakdown" id="breakdown"></div>

      <button class="cta" id="reserveBtn">Reservar via WhatsApp</button>
    </div>
  </div>

<script>
(function () {
  // prices
  const PRICES = {
    rooms: { s1:80, s2:80, s3:100, s4:60 },
    config: { chairPerUnit:4, maca:25, poltronaPerUnit:25, mesa:20 },
    addons: { projector:50, tv:20, desktop:20, notebook:50 }
  };
  const ROOM_DISCOUNTS = {1:0,2:0.05,3:0.10,4:0.15,5:0.20};
  const fmt = v => v.toLocaleString('pt-BR', { style:'currency', currency:'BRL' });

  // get elements
  const roomEl = document.getElementById('room');
  const periodEl = document.getElementById('period');
  const chairsQtyEl = document.getElementById('chairs_qty');
  const poltronaQtyEl = document.getElementById('poltrona_qty');

  const addonProjector = document.getElementById('addon_projector');
  const addonTV = document.getElementById('addon_tv');
  const addonDesktop = document.getElementById('addon_desktop');
  const addonNotebook = document.getElementById('addon_notebook');

  const addonProjectorQ = document.getElementById('addon_projector_q');
  const addonTVQ = document.getElementById('addon_tv_q');
  const addonDesktopQ = document.getElementById('addon_desktop_q');
  const addonNotebookQ = document.getElementById('addon_notebook_q');

  const totalPriceEl = document.getElementById('totalPrice');
  const daysLabel = document.getElementById('daysLabel');
  const breakdown = document.getElementById('breakdown');
  const reserveBtn = document.getElementById('reserveBtn');

  function readRoomPrice() {
    const opt = roomEl.selectedOptions && roomEl.selectedOptions[0];
    if(!opt) return 0;
    let raw = opt.dataset && opt.dataset.price ? String(opt.dataset.price).trim() : '';
    if(raw) {
      const p = parseFloat(raw.replace(',', '.'));
      if(Number.isFinite(p)) return p;
    }
    const m = opt.textContent.match(/(?:R\$)?\s*([0-9\.\,]+)/);
    if(m && m[1]) {
      const cleaned = m[1].replace(/\./g,'').replace(',', '.');
      const p2 = parseFloat(cleaned);
      if(Number.isFinite(p2)) return p2;
    }
    return PRICES.rooms[opt.value] || 0;
  }

  function getSelectedConfig() {
    const sel = document.querySelector('input[name="config"]:checked') || document.querySelector('input[name="config"]');
    return sel ? sel.value : 'chairs';
  }

  function calculate() {
    const baseRoomPrice = readRoomPrice();
    const days = Math.max(1, parseInt(periodEl.value || 1));
    const discount = ROOM_DISCOUNTS[days] || 0;
    const roomPriceAfterDiscount = +(baseRoomPrice * (1 - discount));

    // config
    const cfgSel = document.querySelector('input[name="config"]:checked') || document.querySelector('input[name="config"]');
    const cfg = cfgSel ? cfgSel.value : 'chairs';
    let configTotalPerDay = 0;
    let configDesc = '';
    if(cfg === 'chairs') {
      const qty = Math.max(1, Math.min(10, parseInt(chairsQtyEl.value||1)));
      configTotalPerDay = qty * PRICES.config.chairPerUnit;
      configDesc = `${qty} cadeira(s) universitária(s) — ${fmt(configTotalPerDay)}/dia`;
    } else if(cfg === 'maca') {
      configTotalPerDay = PRICES.config.maca;
      configDesc = `Maca (1) — ${fmt(configTotalPerDay)}/dia`;
    } else if(cfg === 'poltrona') {
      const qty = Math.max(1, Math.min(2, parseInt(poltronaQtyEl.value||1)));
      configTotalPerDay = qty * PRICES.config.poltronaPerUnit;
      configDesc = `${qty} poltrona(s) — ${fmt(configTotalPerDay)}/dia`;
    } else if(cfg === 'mesa') {
      configTotalPerDay = PRICES.config.mesa;
      configDesc = `Mesa de reunião + 6 cadeiras — ${fmt(configTotalPerDay)}/dia`;
    }

    let addonsTotalPerDay = 0;
    const addonsLines = [];
    function addAddon(checkbox, qtyEl, price, label) {
      if(checkbox && checkbox.checked) {
        const q = Math.max(1, parseInt(qtyEl.value||1));
        const v = q * price;
        addonsTotalPerDay += v;
        addonsLines.push(`${q} ${label} — ${fmt(v)}/dia`);
      }
    }
    addAddon(addonProjector, addonProjectorQ, PRICES.addons.projector, 'Projetor(es)');
    addAddon(addonTV, addonTVQ, PRICES.addons.tv, 'TV 32"');
    addAddon(addonDesktop, addonDesktopQ, PRICES.addons.desktop, 'Computador(es) Desktop');
    addAddon(addonNotebook, addonNotebookQ, PRICES.addons.notebook, 'Notebook(s)');

    const perDayTotal = roomPriceAfterDiscount + configTotalPerDay + addonsTotalPerDay;
    const grandTotal = perDayTotal * days;

    totalPriceEl.textContent = fmt(grandTotal);
    daysLabel.textContent = `${days} dia(s)`;

    const roomLabel = roomEl.selectedOptions[0].textContent.split('—')[0].trim();

    let html = `<strong>Resumo</strong><br>`;
    html += `<div class="muted">${roomLabel}: ${fmt(baseRoomPrice)} / dia</div>`;
    if(discount>0) html += `<div class="muted">Desconto na sala: ${Math.round(discount*100)}% → Sala com desconto: ${fmt(roomPriceAfterDiscount)} / dia</div>`;
    else html += `<div class="muted">Desconto na sala: 0% (nenhum)</div>`;
    html += `<div class="muted">${configDesc}</div>`;
    html += addonsLines.length ? `<div class="muted">Adicionais:</div><ul>${addonsLines.map(l=>`<li>${l}</li>`).join('')}</ul>` : `<div class="muted">Adicionais: (nenhum)</div>`;
    html += `<div style="margin-top:8px"><strong>Subtotal por dia:</strong> ${fmt(perDayTotal)}</div>`;
    html += `<div><strong>Total (${days} dia(s)):</strong> ${fmt(grandTotal)}</div>`;

    breakdown.innerHTML = html;

    return { baseRoomPrice, roomPriceAfterDiscount, discount, configDesc, addonsLines, days, perDayTotal, grandTotal, roomLabel };
  }

  // wire events
  ['change','input'].forEach(evt => {
    document.getElementById('simulator-standalone').addEventListener(evt, function(e){
      // enable qty toggles
      if(e.target && e.target.matches('#addon_projector,#addon_tv,#addon_desktop,#addon_notebook')) {
        const q = document.getElementById(e.target.id + '_q');
        if(q) q.disabled = !e.target.checked;
      }
      if(e.target && e.target.matches('input[name="config"]')) {
        const chairs = document.getElementById('chairs_qty');
        const pol = document.getElementById('poltrona_qty');
        const sel = document.querySelector('input[name="config"]:checked');
        if(chairs) chairs.disabled = !(sel && sel.value==='chairs');
        if(pol) pol.disabled = !(sel && sel.value==='poltrona');
      }
      calculate();
    });
  });

  // whatsapp
  reserveBtn.addEventListener('click', function(){
    const data = calculate();
    const greeting = "Olá, estou vindo pelo salapronta.com. Gostaria de atendimento.\n\n";
    const lines = [
      `Sala: ${data.roomLabel}`,
      data.discount>0 ? `Sala (após desconto ${Math.round(data.discount*100)}%): ${fmt(data.roomPriceAfterDiscount)} / dia` : `Sala: ${fmt(data.baseRoomPrice)} / dia`,
      `Configuração: ${data.configDesc}`
    ];
    if(data.addonsLines && data.addonsLines.length) { lines.push('Adicionais:'); data.addonsLines.forEach(l=>lines.push('- '+l)); }
    lines.push(`Período: ${data.days} dia(s)`);
    lines.push(`Subtotal por dia: ${fmt(data.perDayTotal)}`);
    lines.push(`Total estimado: ${fmt(data.grandTotal)}`);
    lines.push('');
    lines.push('Pode verificar a disponibilidade desta sala?');
    const encoded = encodeURIComponent(greeting + lines.join('\n'));
    const wa = `https://api.whatsapp.com/send/?phone=554137979973&text=${encoded}&type=phone_number&app_absent=0`;
    const w = window.open(wa,'_blank');
    setTimeout(()=>{ if(!w || w.closed || typeof w.closed==='undefined') window.location.href = wa; },600);
  });

  // initial calc
  calculate();
})();
</script>
</body>
</html>
